---
title: "main"
output: html_document
date: "2023-07-03"
---

# Today's Link: https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-02-21

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
suppressMessages(library(tidyverse))
suppressMessages(library(stm))
suppressMessages(library(tidytext))
suppressMessages(library(tidylo))
```

```{r EDA}
bob_ross <- read_csv(
  "https://raw.githubusercontent.com/jwilber/Bob_Ross_Paintings/master/data/bob_ross_paintings.csv",
) 

view(bob_ross)
```
```{r EDA}
BrokenTitle <- bob_ross %>%
  select(painting_title) %>%
  mutate(NewTitle = tolower(painting_title)) %>%
  mutate(NewTitle = strsplit(NewTitle, split = " ")) %>%
  unnest(NewTitle) 

stopWords <-
  c("a", "in", "of", "at", "the", "by", "an", "on", "to", "c", "o", "and")
BrokenTitle <- subset(BrokenTitle,!(NewTitle %in% stopWords)) 

```

```{r EDA}
remove <- c("\\[", "\\]", "'", "\\\\n", "\\\\r")
  
colorSelect <- bob_ross %>%
  select(colors, color_hex) %>%
  mutate(
    color_hex = str_remove_all(color_hex, paste(remove, collapse = "|")),
    colors = str_remove_all(colors, paste(remove, collapse = "|")),
    colors = strsplit(colors, ","),
    color_hex = strsplit(color_hex, ",")
  ) %>%
  unnest(c(colors, color_hex)) %>%
  mutate(color_hex = str_trim(color_hex)) %>%
  mutate(colors = str_trim(colors)) %>%
  distinct()

view(colorSelect)

```

```{r EDA}
presentColors <- bob_ross %>% 
  gather(color, present, -c(1:10)) %>%
  filter(present == 1) %>%
  mutate(color = str_to_title(str_replace(color, "_", " ")))

bob_ross <- merge(x = presentColors, y = colorSelect, by.y = "colors", by.x = "color") %>%
  select(-c(2,4,8:12))

view(bob_ross)
```

```{r EDA}
bob_ross %>%
  count(color, color_hex.y, sort = TRUE) %>%
  mutate( color = fct_reorder(color, n)) %>%
  ggplot(aes(color, n, fill = I(color_hex.y))) +
  geom_col() +
  coord_flip()

```

```{r EDA}
 bob_ross %>%
  add_count(season, name = "totalColors") %>%
  count(season, color, totalColors,  sort = TRUE) %>%
  mutate(percentage = n / totalColors) %>%
  filter(color == "Titanium White") %>%
  ggplot(aes(season, percentage)) +
  geom_line() 
  
```

```{r EDA}
bob_ross <-
  merge(x = bob_ross, y = BrokenTitle, by = "painting_title")

```

```{r EDA}
bob_ross %>%
  group_by(NewTitle, season, color) %>%
  filter(NewTitle == "mountain" | NewTitle == "winter" | NewTitle == "day") %>%
  ggplot(aes(season, fill = I(color_hex.y))) +
  geom_bar(stat = "count") +
  facet_wrap(~ NewTitle)
```

